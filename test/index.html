<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>jQuery - XenAPI - XMLRPC - Example</title>
	<script src="../lib/jquery-1.9.1.js"></script>
	<script src="../lib/jquery.xmlrpc-0.2.0.js"></script>
	<script src="../xenapi-0.0.9.min.js"></script>

</head>
<body>
	<form id="test" action="#">
		<input type="text" id="hosturl" placeholder="Host" />
		<input type="text" id="user" placeholder="User" />
		<input type="text" id="pass" placeholder="Pass" />
		<input type="submit" value="Connect" />
	</form>
	<br />
	<div id="output">
	</div>

	<script>

		$('#test').submit(function(e) {
			e.preventDefault();

			var username = $('#user').val()
				, password = $('#pass').val()
				, hostUrl = $('#hosturl').val()
				, demo = new XenAPI(username,password,hostUrl)
				, output = $('#output');

			output.html('Loading...');

			demo.pool.get_all_records(function(err,res) {
				if(err) {
					console.log(err);
					output.html(err);
				} else {
					result = res;
					console.log(res);
					poolref = Object.keys(result)[0];
					params 	= result[poolref].master;
	 				demo.host.get_API_version_major(params, function(err, res) {
						if(err) {
							console.log(err);
							output.html(err);
						}
						else {
							console.log(res);
							output.html(res);
						}
	 				});
				}
			});
		});
	</script>
</body>
</html>
